00000000   3C 23 0D 0A 2E 53 59 4E 4F 50 53 49 53 0D 0A 20  <#...SYNOPSIS.. 
00000010   20 20 20 43 6C 65 61 6E 73 20 75 70 20 72 65 6D     Cleans up rem
00000020   61 69 6E 69 6E 67 20 46 54 64 78 31 30 31 4D 50  aining FTdx101MP
00000030   5F 57 65 62 41 70 70 20 66 69 6C 65 73 0D 0A 2E  _WebApp files...
00000040   44 45 53 43 52 49 50 54 49 4F 4E 0D 0A 20 20 20  DESCRIPTION..   
00000050   20 52 65 6E 61 6D 65 73 20 2E 73 6C 6E 78 2C 20   Renames .slnx, 
00000060   2E 63 73 70 72 6F 6A 2E 75 73 65 72 2C 20 61 6E  .csproj.user, an
00000070   64 20 75 70 64 61 74 65 73 20 72 65 66 65 72 65  d updates refere
00000080   6E 63 65 73 20 69 6E 73 69 64 65 20 74 68 65 6D  nces inside them
00000090   0D 0A 23 3E 0D 0A 0D 0A 24 6F 6C 64 4E 61 6D 65  ..#>....$oldName
000000A0   20 3D 20 22 46 54 64 78 31 30 31 4D 50 5F 57 65   = "FTdx101MP_We
000000B0   62 41 70 70 22 0D 0A 24 6E 65 77 4E 61 6D 65 20  bApp"..$newName 
000000C0   3D 20 22 46 54 64 78 31 30 31 5F 57 65 62 41 70  = "FTdx101_WebAp
000000D0   70 22 0D 0A 0D 0A 57 72 69 74 65 2D 48 6F 73 74  p"....Write-Host
000000E0   20 22 60 6E 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D   "`n============
000000F0   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
00000100   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 22 20 2D 46  ============" -F
00000110   6F 72 65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 43  oregroundColor C
00000120   79 61 6E 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20  yan..Write-Host 
00000130   22 20 20 43 6C 65 61 6E 75 70 20 52 65 6D 61 69  "  Cleanup Remai
00000140   6E 69 6E 67 20 46 69 6C 65 73 22 20 2D 46 6F 72  ning Files" -For
00000150   65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 43 79 61  egroundColor Cya
00000160   6E 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20 22 3D  n..Write-Host "=
00000170   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
00000180   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
00000190   3D 3D 3D 3D 3D 3D 3D 60 6E 22 20 2D 46 6F 72 65  =======`n" -Fore
000001A0   67 72 6F 75 6E 64 43 6F 6C 6F 72 20 43 79 61 6E  groundColor Cyan
000001B0   0D 0A 0D 0A 23 20 53 74 65 70 20 31 3A 20 55 70  ....# Step 1: Up
000001C0   64 61 74 65 20 2E 73 6C 6E 78 20 63 6F 6E 74 65  date .slnx conte
000001D0   6E 74 0D 0A 69 66 20 28 54 65 73 74 2D 50 61 74  nt..if (Test-Pat
000001E0   68 20 22 24 6F 6C 64 4E 61 6D 65 2E 73 6C 6E 78  h "$oldName.slnx
000001F0   22 29 20 7B 0D 0A 20 20 20 20 57 72 69 74 65 2D  ") {..    Write-
00000200   48 6F 73 74 20 22 55 70 64 61 74 69 6E 67 20 24  Host "Updating $
00000210   6F 6C 64 4E 61 6D 65 2E 73 6C 6E 78 20 63 6F 6E  oldName.slnx con
00000220   74 65 6E 74 2E 2E 2E 22 20 2D 46 6F 72 65 67 72  tent..." -Foregr
00000230   6F 75 6E 64 43 6F 6C 6F 72 20 43 79 61 6E 0D 0A  oundColor Cyan..
00000240   20 20 20 20 24 63 6F 6E 74 65 6E 74 20 3D 20 47      $content = G
00000250   65 74 2D 43 6F 6E 74 65 6E 74 20 22 24 6F 6C 64  et-Content "$old
00000260   4E 61 6D 65 2E 73 6C 6E 78 22 20 2D 52 61 77 0D  Name.slnx" -Raw.
00000270   0A 20 20 20 20 24 63 6F 6E 74 65 6E 74 20 3D 20  .    $content = 
00000280   24 63 6F 6E 74 65 6E 74 20 2D 72 65 70 6C 61 63  $content -replac
00000290   65 20 5B 72 65 67 65 78 5D 3A 3A 45 73 63 61 70  e [regex]::Escap
000002A0   65 28 24 6F 6C 64 4E 61 6D 65 29 2C 20 24 6E 65  e($oldName), $ne
000002B0   77 4E 61 6D 65 0D 0A 20 20 20 20 24 63 6F 6E 74  wName..    $cont
000002C0   65 6E 74 20 7C 20 53 65 74 2D 43 6F 6E 74 65 6E  ent | Set-Conten
000002D0   74 20 22 24 6F 6C 64 4E 61 6D 65 2E 73 6C 6E 78  t "$oldName.slnx
000002E0   22 20 2D 4E 6F 4E 65 77 6C 69 6E 65 0D 0A 20 20  " -NoNewline..  
000002F0   20 20 57 72 69 74 65 2D 48 6F 73 74 20 22 20 20    Write-Host "  
00000300   3F 3F 3F 20 55 70 64 61 74 65 64 20 70 72 6F 6A  ??? Updated proj
00000310   65 63 74 20 72 65 66 65 72 65 6E 63 65 20 69 6E  ect reference in
00000320   73 69 64 65 20 2E 73 6C 6E 78 60 6E 22 20 2D 46  side .slnx`n" -F
00000330   6F 72 65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 47  oregroundColor G
00000340   72 65 65 6E 0D 0A 7D 0D 0A 0D 0A 23 20 53 74 65  reen..}....# Ste
00000350   70 20 32 3A 20 52 65 6E 61 6D 65 20 61 6C 6C 20  p 2: Rename all 
00000360   72 65 6D 61 69 6E 69 6E 67 20 66 69 6C 65 73 0D  remaining files.
00000370   0A 24 66 69 6C 65 73 52 65 6E 61 6D 65 64 20 3D  .$filesRenamed =
00000380   20 30 0D 0A 47 65 74 2D 43 68 69 6C 64 49 74 65   0..Get-ChildIte
00000390   6D 20 2D 50 61 74 68 20 2E 20 2D 46 69 6C 74 65  m -Path . -Filte
000003A0   72 20 22 24 6F 6C 64 4E 61 6D 65 2A 22 20 2D 46  r "$oldName*" -F
000003B0   69 6C 65 20 7C 20 46 6F 72 45 61 63 68 2D 4F 62  ile | ForEach-Ob
000003C0   6A 65 63 74 20 7B 0D 0A 20 20 20 20 24 6E 65 77  ject {..    $new
000003D0   46 69 6C 65 4E 61 6D 65 20 3D 20 24 5F 2E 4E 61  FileName = $_.Na
000003E0   6D 65 20 2D 72 65 70 6C 61 63 65 20 5B 72 65 67  me -replace [reg
000003F0   65 78 5D 3A 3A 45 73 63 61 70 65 28 24 6F 6C 64  ex]::Escape($old
00000400   4E 61 6D 65 29 2C 20 24 6E 65 77 4E 61 6D 65 0D  Name), $newName.
00000410   0A 20 20 20 20 57 72 69 74 65 2D 48 6F 73 74 20  .    Write-Host 
00000420   22 52 65 6E 61 6D 69 6E 67 3A 20 24 28 24 5F 2E  "Renaming: $($_.
00000430   4E 61 6D 65 29 22 20 2D 46 6F 72 65 67 72 6F 75  Name)" -Foregrou
00000440   6E 64 43 6F 6C 6F 72 20 59 65 6C 6C 6F 77 0D 0A  ndColor Yellow..
00000450   20 20 20 20 57 72 69 74 65 2D 48 6F 73 74 20 22      Write-Host "
00000460   20 20 20 20 20 54 6F 3A 20 24 6E 65 77 46 69 6C       To: $newFil
00000470   65 4E 61 6D 65 22 20 2D 46 6F 72 65 67 72 6F 75  eName" -Foregrou
00000480   6E 64 43 6F 6C 6F 72 20 47 72 65 65 6E 0D 0A 20  ndColor Green.. 
00000490   20 20 20 52 65 6E 61 6D 65 2D 49 74 65 6D 20 2D     Rename-Item -
000004A0   50 61 74 68 20 24 5F 2E 46 75 6C 6C 4E 61 6D 65  Path $_.FullName
000004B0   20 2D 4E 65 77 4E 61 6D 65 20 24 6E 65 77 46 69   -NewName $newFi
000004C0   6C 65 4E 61 6D 65 0D 0A 20 20 20 20 24 66 69 6C  leName..    $fil
000004D0   65 73 52 65 6E 61 6D 65 64 2B 2B 0D 0A 7D 0D 0A  esRenamed++..}..
000004E0   0D 0A 57 72 69 74 65 2D 48 6F 73 74 20 22 60 6E  ..Write-Host "`n
000004F0   3F 3F 3F 20 52 65 6E 61 6D 65 64 20 24 66 69 6C  ??? Renamed $fil
00000500   65 73 52 65 6E 61 6D 65 64 20 66 69 6C 65 28 73  esRenamed file(s
00000510   29 22 20 2D 46 6F 72 65 67 72 6F 75 6E 64 43 6F  )" -ForegroundCo
00000520   6C 6F 72 20 47 72 65 65 6E 0D 0A 0D 0A 23 20 53  lor Green....# S
00000530   74 65 70 20 33 3A 20 55 70 64 61 74 65 20 47 69  tep 3: Update Gi
00000540   74 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20 22 60  t..Write-Host "`
00000550   6E 55 70 64 61 74 69 6E 67 20 47 69 74 2E 2E 2E  nUpdating Git...
00000560   22 20 2D 46 6F 72 65 67 72 6F 75 6E 64 43 6F 6C  " -ForegroundCol
00000570   6F 72 20 43 79 61 6E 0D 0A 67 69 74 20 61 64 64  or Cyan..git add
00000580   20 2D 41 0D 0A 67 69 74 20 73 74 61 74 75 73 20   -A..git status 
00000590   2D 2D 73 68 6F 72 74 20 7C 20 46 6F 72 45 61 63  --short | ForEac
000005A0   68 2D 4F 62 6A 65 63 74 20 7B 20 57 72 69 74 65  h-Object { Write
000005B0   2D 48 6F 73 74 20 22 20 20 24 5F 22 20 2D 46 6F  -Host "  $_" -Fo
000005C0   72 65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 47 72  regroundColor Gr
000005D0   61 79 20 7D 0D 0A 0D 0A 67 69 74 20 63 6F 6D 6D  ay }....git comm
000005E0   69 74 20 2D 6D 20 22 72 65 66 61 63 74 6F 72 3A  it -m "refactor:
000005F0   20 52 65 6E 61 6D 65 20 72 65 6D 61 69 6E 69 6E   Rename remainin
00000600   67 20 75 73 65 72 20 61 6E 64 20 73 6F 6C 75 74  g user and solut
00000610   69 6F 6E 20 66 69 6C 65 73 0D 0A 0D 0A 2D 20 52  ion files....- R
00000620   65 6E 61 6D 65 64 20 46 54 64 78 31 30 31 4D 50  enamed FTdx101MP
00000630   5F 57 65 62 41 70 70 2E 73 6C 6E 78 20 74 6F 20  _WebApp.slnx to 
00000640   46 54 64 78 31 30 31 5F 57 65 62 41 70 70 2E 73  FTdx101_WebApp.s
00000650   6C 6E 78 0D 0A 2D 20 52 65 6E 61 6D 65 64 20 46  lnx..- Renamed F
00000660   54 64 78 31 30 31 4D 50 5F 57 65 62 41 70 70 2E  Tdx101MP_WebApp.
00000670   63 73 70 72 6F 6A 2E 75 73 65 72 20 74 6F 20 46  csproj.user to F
00000680   54 64 78 31 30 31 5F 57 65 62 41 70 70 2E 63 73  Tdx101_WebApp.cs
00000690   70 72 6F 6A 2E 75 73 65 72 0D 0A 2D 20 55 70 64  proj.user..- Upd
000006A0   61 74 65 64 20 70 72 6F 6A 65 63 74 20 72 65 66  ated project ref
000006B0   65 72 65 6E 63 65 73 20 69 6E 73 69 64 65 20 2E  erences inside .
000006C0   73 6C 6E 78 20 66 69 6C 65 22 0D 0A 0D 0A 57 72  slnx file"....Wr
000006D0   69 74 65 2D 48 6F 73 74 20 22 3F 3F 3F 20 47 69  ite-Host "??? Gi
000006E0   74 20 63 6F 6D 6D 69 74 20 63 72 65 61 74 65 64  t commit created
000006F0   60 6E 22 20 2D 46 6F 72 65 67 72 6F 75 6E 64 43  `n" -ForegroundC
00000700   6F 6C 6F 72 20 47 72 65 65 6E 0D 0A 0D 0A 57 72  olor Green....Wr
00000710   69 74 65 2D 48 6F 73 74 20 22 3D 3D 3D 3D 3D 3D  ite-Host "======
00000720   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
00000730   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
00000740   3D 3D 22 20 2D 46 6F 72 65 67 72 6F 75 6E 64 43  ==" -ForegroundC
00000750   6F 6C 6F 72 20 43 79 61 6E 0D 0A 57 72 69 74 65  olor Cyan..Write
00000760   2D 48 6F 73 74 20 22 20 20 20 43 6C 65 61 6E 75  -Host "   Cleanu
00000770   70 20 43 6F 6D 70 6C 65 74 65 21 22 20 2D 46 6F  p Complete!" -Fo
00000780   72 65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 47 72  regroundColor Gr
00000790   65 65 6E 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20  een..Write-Host 
000007A0   22 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  "===============
000007B0   3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D 3D  ================
000007C0   3D 3D 3D 3D 3D 3D 3D 3D 3D 60 6E 22 20 2D 46 6F  =========`n" -Fo
000007D0   72 65 67 72 6F 75 6E 64 43 6F 6C 6F 72 20 43 79  regroundColor Cy
000007E0   61 6E 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20 22  an..Write-Host "
000007F0   52 65 61 64 79 20 74 6F 20 70 75 73 68 3A 20 22  Ready to push: "
00000800   20 2D 46 6F 72 65 67 72 6F 75 6E 64 43 6F 6C 6F   -ForegroundColo
00000810   72 20 59 65 6C 6C 6F 77 20 2D 4E 6F 4E 65 77 6C  r Yellow -NoNewl
00000820   69 6E 65 0D 0A 57 72 69 74 65 2D 48 6F 73 74 20  ine..Write-Host 
00000830   22 67 69 74 20 70 75 73 68 20 6F 72 69 67 69 6E  "git push origin
00000840   20 6D 61 69 6E 22 20 2D 46 6F 72 65 67 72 6F 75   main" -Foregrou
00000850   6E 64 43 6F 6C 6F 72 20 57 68 69 74 65 0D 0A 57  ndColor White..W
00000860   72 69 74 65 2D 48 6F 73 74 20 22 22 0D 0A        rite-Host ""..  
